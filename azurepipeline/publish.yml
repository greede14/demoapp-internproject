steps:
  - task: UseDotNet@2
    inputs:
    version: '5.x'
  - script: |
      dotnet tool install --global Microsoft.CodeAnalysis.Sarif.Multitool
      sarif-multitool merge -o merged.sarif trivyimagescan.sarif trivycodescan.sarif
    displayName: 'Merge SARIF files'

  - task: PublishPipelineArtifact@1
    inputs:
        targetPath: $(Pipeline.Workspace)/merged.sarif
        artifact: 'CodeAnalysisLogs'
        publishLocation: 'pipeline'
    displayName: 'publish trivyimagescan.sarif'


# steps: 
#   - task: PublishPipelineArtifact@1
#     inputs:
#         targetPath: $(Pipeline.Workspace)/trivyimagescan.sarif
#         artifact: 'CodeAnalysisLogs'
#         publishLocation: 'pipeline'
#     displayName: 'publish trivyimagescan.sarif'

#   - task: PublishPipelineArtifact@1
#     inputs:
#         targetPath: $(Pipeline.Workspace)/trivycodescan.sarif
#         artifact: 'CodeAnalysisLogs code vulnerability secret config'
#         publishLocation: 'pipeline'
#     displayName: 'publish trivycodescan.sarif'

# steps:
#   - task: PublishPipelineArtifact@1
#     inputs:
#         targetPath: $(Pipeline.Workspace)/*.sarif
#         artifact: 'CodeAnalysisLogs'
#         publishLocation: 'pipeline'
#     displayName: 'publish trivyimagescan.sarif'

  # - task: PublishPipelineArtifact@1
  #   inputs:
  #       targetPath: $(Pipeline.Workspace)/trivycodescan.sarif
  #       artifact: 'CodeAnalysisLogs code vulnerability secret config'
  #       publishLocation: 'pipeline'
  #   displayName: 'publish trivycodescan.sarif'